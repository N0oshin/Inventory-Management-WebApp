<br>
<br>
{% extends 'base3.html' %}

{% block content %}

<style>
  body {
    background-color: #F9F8ED;
  }
</style>

<h1 style="text-align:center; font-family:roboto; margin-top:50px;">Your Cart</h1>

<div class="container">
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th scope="col">Item ID</th>
        <th scope="col">Product Name</th>
        <th scope="col">Quantity</th>
        <th scope="col">Price per Unit</th>
        <th scope="col">Total Price</th>
        <th scope="col">Action</th>
      </tr>
    </thead>
    <tbody>
      {% set total_price = 0 %}
      {% if session['cart'] %}
      {% for item_id, item_data in session['cart'].items() %}
      <tr>
        <th scope="row">{{ item_id }}</th>
        <td>{{ item_data['name'] }}</td>
        <td>{{ item_data['quantity'] }}</td>
        <td>{{ item_data['price'] }} Rs</td>
        {% set item_total = item_data['price'] * item_data['quantity'] %}
        <td>{{ item_total }} Rs</td>
        <td>
          <form action="{{ url_for('remove_from_cart', item_id=item_id) }}" method="POST">
            <button type="submit" class="btn btn-danger btn-sm">Remove</button>
          </form>
        </td>
      </tr>
      {% set total_price = total_price + item_total %}
      {% endfor %}
      {% else %}
      <tr>
        <td colspan="6" class="text-center">Your cart is empty.</td>
      </tr>
      {% endif %}
    </tbody>
    <tfoot>
      <tr>
        <td colspan="4" class="text-right"><strong>Grand Total:</strong></td>
        <td><strong>{{ total_price }} Rs</strong></td>
        <td></td>
      </tr>
    </tfoot>
  </table>
  <div class="d-flex justify-content-center mt-4">
    <form action="{{ url_for('create_checkout_session') }}" method="POST">
      <button type="submit" class="btn btn-primary btn-lg">Proceed to Checkout</button>
    </form>
  </div>

</div>

{% endblock %}